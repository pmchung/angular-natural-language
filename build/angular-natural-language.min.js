/*! angular-natural-language 2018-04-26 */
angular.module("vr.directives.nlForm",["vr.directives.nlForm.select","vr.directives.nlForm.text"]),angular.module("vr.directives.nlForm.select",[]).directive("nlSelect",function(){return{restrict:"EA",replace:!0,scope:{value:"=",options:"="},controller:"nlSelectCtrl",template:"<span ng-form='nlSelect' class='nl-field nl-dd' ng-class=\"{'nl-field-open': opened}\"><a class='nl-field-toggle' ng-class='{ \"nl-valid\": value && value.length > 0  }' ng-click='open($event)'>{{ !value ? none : getSelected() }} </a><ul><li class='nl-dd-title' ng-bind='title'></li><li ng-show='allOptions && multiple && !isAllSelected()' ng-bind='allOptions' ng-click='selectAll()'></li><li ng-repeat='label in getLabels()' ng-class=\"{'nl-dd-checked': !multiple && isSelected(label.label)}\" ng-click='select(label.label)'><div class='nl-dd-image' ng-if='label.image'><img ng-src='{{label.image}}' /></div><div class='nl-dd-label' ng-bind='label.label' /><div class='nl-dd-checkbox' ng-if='multiple'><span class='check-box'><input type='checkbox' ng-checked='isSelected(label.label)' /><span class='checkmark'></span></span ></div></li><li class='nl-field-other' ng-show='allowOther'><input type='text' placeholder='Specify other' ng-model='otherValue' ng-change='selectOther(otherValue)' /></li></ul></span>",link:function(a,b,c){a.allowOther=!angular.isUndefined(c.allowOther),a.required=!angular.isUndefined(c.required),a.multiple=!angular.isUndefined(c.multiple),a.conjunction=a.multiple&&""!=c.multiple?c.multiple:"and",a.none=angular.isUndefined(c.none)?"none":c.none,a.title=c.title,a.allOptions=angular.isUndefined(c.all)?!1:c.all,a.multiple&&angular.isUndefined(a.value)&&(a.value=[]),a.multiple&&!angular.isArray(a.value)&&(a.value=[a.value]);var d=!1;angular.forEach(b.parent().children(),function(a){a=angular.element(a),a.hasClass("nl-overlay")&&(d=a)}),d||(d=angular.element('<div class="nl-overlay"></div>'),b.parent().append(d)),d.bind("click",function(){a.$apply(a.close)})}}}).controller("nlSelectCtrl",["$scope",function(a){function b(b){var c=!1;return angular.forEach(a.options,function(d){switch(a.optionType){case h:case j:b==d&&(c=!0);break;case i:case k:b==d.value&&(c=!0)}}),c}function c(){switch(a.optionType){case h:case i:return a.options.length;case k:case j:var b=0;return angular.forEach(a.options,function(){b++}),b}return 0}function d(b){var c=b;switch(a.optionType){case i:case k:angular.forEach(a.options,function(a){a.value==b&&(c=a.label)});break;case h:break;case j:angular.forEach(a.options,function(a,d){b==a&&(c=d)})}return c}function e(b){var c=b;switch(a.optionType){case h:break;case i:angular.forEach(a.options,function(a){a.label==b&&(c=a.value)});break;case j:c=a.options[b];break;case k:a.selectedOther||(c=a.options[b].value)}return c}function f(b){var c=b;switch(a.optionType){case h:break;case j:angular.forEach(a.options,function(a,d){b==a&&(c=d)});break;case i:angular.forEach(a.options,function(a){a.value==b.value&&(c=a.label)});break;case k:angular.forEach(a.options,function(a,d){b==a&&(c=d)})}return c}function g(){if(a.multiple){var c=[];angular.forEach(a.value,function(a){b(a)&&c.push(a)}),a.value=c}}var h=1,i=2,j=3,k=4;a.opened=!1,a.open=function(b){b.stopPropagation(),a.opened=!0},a.close=function(){a.opened=!1},a.select=function(b){a.setValue(b),a.selectedOther=!1,a.otherValue="",a.multiple||a.close()},a.selectAll=function(){angular.forEach(a.options,function(b){var c=f(b);a.isSelected(c)||a.select(c),a.close()})},a.selectOther=function(b){a.selectedOther=b.length>0,a.value=a.otherValue,a.selectNone(!0),0===b.length&&(a.value=void 0)},a.selectNone=function(b){angular.forEach(a.options,function(c){var d=f(c);a.isSelected(d)&&a.select(d),b||a.close()})},a.isAllSelected=function(){return!angular.isUndefined(a.value)&&a.value.length==c()},a.isNoneSelected=function(){return angular.isUndefined(a.value)||0==a.value.length},a.setValue=function(b){var c=e(b);if(a.multiple){var d=a.value.indexOf(c);-1==d?a.value.push(c):a.value.splice(d,1),a.required&&(0==a.value.length?a.nlSelect.$setValidity("required",!1):a.nlSelect.$setValidity("required",!0))}else a.value=c},a.getLabels=function(){switch(a.optionType){case h:return a.options;case i:return a.options.map(function(a){return a});case j:case k:var b=[];return angular.forEach(a.options,function(c,d){a.optionType==j?b.push(d):b.push(c.label)}),b}return[]},a.getSelected=function(){if(a.multiple){var b="";if(!angular.isUndefined(a.value)&&a.value.length>0)if(a.allOptions&&a.value.length==c())b=a.allOptions;else{var e="",f=1;angular.forEach(a.value,function(c){b+=e+d(c),f++,e=a.value.length>2?", ":" ",f==a.value.length&&(e+=a.conjunction+" ")})}else b=a.none;return b}return d(a.value)},a.isSelected=function(b){return angular.isUndefined(a.value)?!1:a.multiple?a.value.indexOf(e(b))>-1:a.value==e(b)},a.$watch("options",function(){if(a.optionType=null,angular.isArray(a.options))angular.isObject(a.options[0])?a.optionType=i:a.optionType=h;else if(angular.isObject(a.options))for(var b in a.options)if(a.options.hasOwnProperty(b)){angular.isObject(a.options[b])?a.optionType=k:a.optionType=j;break}g()},!0)}]),angular.module("vr.directives.nlForm.text",[]).directive("nlText",function(){return{restrict:"EA",replace:!0,scope:{placeholder:"@",subline:"@",name:"@",value:"="},template:'<span ng-form class="nl-field nl-ti-text" ng-class="{\'nl-field-open\': opened}"><a class="nl-field-toggle"  ng-class="{\'nl-valid\': value }" ng-click="open($event)" ng-bind="viewValue()"></a><ul><li class="nl-ti-input"><input type="text" placeholder="{{ placeholder }}" name="{{ name }}" ng-model="value" ng-click="$event.stopPropagation()" ng-required="required"/><button class="nl-field-go" ng-click="close()">Go</button></li><li class="nl-ti-example" ng-show="showSubline()" ng-bind-html-unsafe="subline"></li></ul></span>',controller:"nlTextCtrl",link:function(a,b,c){a.required=!angular.isUndefined(c.required);var d=!1;angular.forEach(b.parent().children(),function(a){a=angular.element(a),a.hasClass("nl-overlay")&&(d=a)}),d||(d=angular.element('<div class="nl-overlay"></div>'),b.parent().append(d)),d.bind("click",function(){a.$apply(a.close)})}}}).controller("nlTextCtrl",["$scope",function(a){a.opened=!1,a.open=function(b){b.stopPropagation(),a.opened=!0},a.close=function(){a.opened=!1},a.viewValue=function(){return""==a.value?a.placeholder:a.value},a.showSubline=function(){return angular.isString(a.subline)&&""!=a.subline}}]);